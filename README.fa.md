# اپلیکیشن ترسیم بازگشتی سه‌بعدی

این یک اپلیکیشن تحت وب است که به کاربران امکان می‌دهد با افزودن اشکال اولیه و سپس تعریف "فضاهای بازگشتی"، صحنه‌های سه‌بعدی ایجاد کنند. یک فضای بازگشتی محتویات یک فضای والد (چه صحنه اصلی و چه یک فضای بازگشتی دیگر) را کپی کرده و مجموعه جدیدی از تبدیلات (موقعیت، چرخش، مقیاس) را به آن اعمال می‌کند. این قابلیت امکان ایجاد ساختارهای سه‌بعدی پیچیده، تودرتو و فراکتال‌مانند را فراهم می‌کند.

ساخته شده با Three.js.

## نحوه اجرا

1.  این مخزن را کلون کرده یا فایل‌ها را دانلود کنید.
2.  فایل `index.html` را در یک مرورگر وب مدرن که از WebGL پشتیبانی می‌کند باز کنید.

## نحوه استفاده

1.  **افزودن اشکال به صحنه اصلی:**
    *   از دکمه‌های "Add Cube" (افزودن مکعب)، "Add Sphere" (افزودن کره)، "Add Cylinder" (افزودن استوانه) یا "Add Cone" (افزودن مخروط) برای افزودن این اشکال به صحنه اصلی سه‌بعدی استفاده کنید.
    *   این اشکال پایه اولیه طرح‌های بازگشتی شما را تشکیل می‌دهند.
    *   می‌توانید با استفاده از ماوس در صحنه حرکت کنید (کنترل‌های مداری: کلیک چپ و کشیدن برای چرخش، کلیک راست و کشیدن برای جابجایی، چرخ اسکرول برای بزرگنمایی).

2.  **تعریف یک فضای بازگشتی:**
    *   **فضای والد:** در بخش "Recursive Space Properties" (خصوصیات فضای بازگشتی)، از منوی کشویی "Parent Space" (فضای والد) برای انتخاب منبع فضای بازگشتی جدید خود استفاده کنید.
        *   "Main Scene" (صحنه اصلی): فضای جدید یک کپی بازگشتی از تمام اشیاء موجود در بخش اصلی و غیربازگشتی صحنه خواهد بود.
        *   یک "RSX" موجود (مثلاً "RS0"): فضای جدید یک کپی بازگشتی از *تعریف* فضای بازگشتی موجود انتخاب‌شده خواهد بود. این امکان بازگشت چندسطحی را فراهم می‌کند.
    *   **تبدیلات:** `Position` (موقعیت)، `Rotation` (چرخش - به درجه) و `Scale` (مقیاس) را برای فضای بازگشتی جدید تنظیم کنید. این تبدیلات *نسبت به مبدأ فضای والد انتخاب‌شده* هستند.
    *   **Define (تعریف):** روی دکمه "Define Recursive Space" (تعریف فضای بازگشتی) کلیک کنید. این کار تعریف را ثبت کرده و صحنه را به‌طور خودکار رندر می‌کند، شامل سطح بازگشتی جدید.

3.  **رندرینگ:**
    *   فضاهای بازگشتی معمولاً هنگام تعریف به‌طور خودکار رندر می‌شوند.
    *   دکمه "Render Recursive Spaces" (رندر فضاهای بازگشتی) می‌تواند برای فعال‌سازی دستی رندر مجدد تمام فضاهای بازگشتی تعریف‌شده در صورت نیاز استفاده شود.

## ویژگی‌ها

*   افزودن مکعب، کره، استوانه و مخروط.
*   تعریف فضاهای بازگشتی با تبدیلات تحت کنترل کاربر (موقعیت، چرخش، مقیاس).
*   بازگشت چندسطحی: فضاهای بازگشتی می‌توانند بر اساس فضاهای بازگشتی دیگر باشند.
*   کنترل‌های پایه صحنه سه‌بعدی (مداری، جابجایی، بزرگنمایی).

## ساختار پروژه

*   `index.html`: فایل HTML اصلی که ساختار صفحه را تنظیم می‌کند، شامل عناصر رابط کاربری (دکمه‌ها، ورودی‌ها) است و کتابخانه Three.js و اسکریپت `main.js` را بارگیری می‌کند.
*   `main.js`: شامل تمام کدهای جاوااسکریپت برای منطق اپلیکیشن است. این شامل راه‌اندازی صحنه، دوربین، رندرکننده، نورها و کنترل‌های Three.js است. همچنین افزودن اشکال اولیه به صحنه و منطق اصلی برای تعریف و رندر فضاهای بازگشتی را مدیریت می‌کند.

## منطق اصلی در `main.js`

*   **راه‌اندازی صحنه**: صحنه، دوربین، رندرکننده و نورپردازی Three.js را مقداردهی اولیه می‌کند. کنترل‌های مداری برای ناوبری و یک صفحه زمین اضافه می‌کند.
*   **ایجاد اشکال**: توابعی مانند `addCube()`، `addSphere()` و غیره، اشکال هندسی پایه را ایجاد و به صحنه اصلی اضافه می‌کنند. این اشیاء در آرایه `sceneObjects` ردیابی می‌شوند.
*   **تعریف فضای بازگشتی**: تابع `defineNewRecursiveSpace()` مرکزی است. داده‌های شیء را از یک فضای والد انتخاب‌شده (چه صحنه اصلی یا یک فضای بازگشتی دیگر) ثبت می‌کند. این تعریف را به همراه تبدیلات تعریف‌شده توسط کاربر (موقعیت، چرخش، مقیاس) ذخیره می‌کند. هر فضای بازگشتی یک نمونه از کلاس `RecursiveSpace` است و به آرایه `recursiveSpaces` اضافه می‌شود.
*   **رندر فضاهای بازگشتی**: تابع `renderRecursiveSpaces()` رندرهای بازگشتی قبلی را پاک کرده و سپس در تعاریف `recursiveSpaces` پیمایش می‌کند. گروه‌هایی از اشیاء را بر اساس این تعاریف ایجاد می‌کند و تبدیلات مشخص‌شده را به‌صورت سلسله‌مراتبی اعمال می‌کند. اگر والد یک فضای بازگشتی، فضای بازگشتی دیگری باشد، گروه آن به عنوان فرزند به گروه والد اضافه می‌شود و ساختار تودرتو را ایجاد می‌کند.
